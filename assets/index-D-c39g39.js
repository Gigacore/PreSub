import{j as t,r as U,u as de,c as me}from"./vendor-react-DGGlJWbK.js";import{v as fe,G as pe,g as ue}from"./vendor-pdf-rjkCHUUQ.js";import{r as ge,m as he}from"./vendor-office-DtySpPMT.js";import{J as ne,l as xe}from"./vendor-media-Dv27I1Yj.js";import"./vendor-Bl7pUl7Z.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function e(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=e(n);fetch(n.href,i)}})();function ye(){return t.jsxs("header",{className:"text-center mb-8 sm:mb-10",children:[t.jsx("h1",{className:"tracking-tight",children:t.jsx("img",{src:"/PreSub/assets/presub-logo.png",alt:"PreSub logo",className:"mx-auto h-20 sm:h-24 md:h-28 lg:h-32 w-auto",loading:"eager",decoding:"async"})}),t.jsx("p",{className:"text-base sm:text-lg mt-2 text-gray-600 max-w-2xl mx-auto px-2",children:"Scan your documents securely in the browser—no data leaves your device."})]})}function be(){return t.jsx("footer",{className:"mx-auto max-w-7xl mt-12 text-center text-sm text-gray-500",children:t.jsxs("p",{children:["PreSub is open source — view and contribute on"," ",t.jsx("a",{href:"https://github.com/Gigacore/PreSub",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:underline",children:"GitHub"}),"."]})})}function we({onFilesSelected:s}){const[m,e]=U.useState(null),a=U.useMemo(()=>({...{"application/pdf":[".pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"],"text/csv":[".csv"],"text/markdown":[".md",".markdown"],"application/json":[".json"]},"image/jpeg":[".jpg",".jpeg"],"image/png":[".png"],"image/svg+xml":[".svg"],"image/tiff":[".tif",".tiff"]}),[]),n=U.useMemo(()=>{const d=new Set;return Object.values(a).forEach(l=>{l.forEach(h=>d.add(h.toLowerCase()))}),d},[a]),i=U.useMemo(()=>{const d=navigator.userAgent||"",l=/Android/i.test(d),h=/iPhone|iPad|iPod/i.test(d)||d.includes("Macintosh")&&navigator.maxTouchPoints>1,o=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)").matches:!1;return l||h||o},[]),r=d=>{const h=(d.name||"").toLowerCase(),o=h.lastIndexOf("."),x=o>=0?h.slice(o):"";return n.has(x)?null:{code:"file-invalid-type",message:"Unsupported file type. Please select a supported format."}},{getRootProps:u,getInputProps:f,isDragActive:c}=de({onDrop:d=>{e(null),s(d)},onDropRejected:d=>{d.map(h=>h.file.name.toLowerCase()).filter(h=>h.endsWith(".doc")||h.endsWith(".ppt")||h.endsWith(".xls")).length>0?e("Legacy formats (.doc, .ppt, .xls) are not supported. Please convert to .docx, .pptx, or .xlsx."):e("Some files were rejected due to type restrictions.")},accept:i?void 0:a,validator:r});return t.jsxs(t.Fragment,{children:[t.jsxs("div",{...u(),className:`border-2 border-dashed rounded-2xl p-6 sm:p-10 md:p-12 text-center cursor-pointer mb-8 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 ${c?"border-blue-500 bg-blue-50":"border-gray-300 bg-gray-100 hover:bg-gray-200"}`,children:[t.jsx("input",{...f()}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined text-gray-500 text-5xl sm:text-6xl",children:"cloud_upload"}),t.jsx("p",{className:"mt-4 text-base sm:text-lg font-semibold text-gray-700",children:c?"Drop the files here ...":"Drop files here or tap to select"}),t.jsx("p",{className:"text-sm text-gray-600 mb-6 px-2",children:"PreSub can make mistakes — please double-check important information."}),t.jsxs("ul",{className:"flex justify-center flex-wrap gap-2 sm:gap-3","aria-label":"Supported formats",role:"list",children:[t.jsx("li",{children:t.jsx("span",{className:"inline-flex items-center rounded-full px-2.5 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium bg-pink-100 text-pink-700 ring-1 ring-inset ring-pink-200",children:"PDF"})}),t.jsx("li",{children:t.jsx("span",{className:"inline-flex items-center rounded-full px-2.5 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium bg-sky-100 text-sky-700 ring-1 ring-inset ring-sky-200",children:"Word"})}),t.jsx("li",{children:t.jsx("span",{className:"inline-flex items-center rounded-full px-2.5 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium bg-green-100 text-green-700 ring-1 ring-inset ring-green-200",children:"Excel"})}),t.jsx("li",{children:t.jsx("span",{className:"inline-flex items-center rounded-full px-2.5 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium bg-orange-100 text-orange-700 ring-1 ring-inset ring-orange-200",children:"PowerPoint"})}),t.jsx("li",{children:t.jsx("span",{className:"inline-flex items-center rounded-full px-2.5 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium bg-emerald-100 text-emerald-700 ring-1 ring-inset ring-emerald-200",children:"CSV"})}),t.jsx("li",{children:t.jsx("span",{className:"inline-flex items-center rounded-full px-2.5 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium bg-purple-100 text-purple-700 ring-1 ring-inset ring-purple-200",children:"Markdown"})}),t.jsx("li",{children:t.jsx("span",{className:"inline-flex items-center rounded-full px-2.5 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium bg-gray-200 text-gray-800 ring-1 ring-inset ring-gray-300",children:"JSON"})}),t.jsx("li",{children:t.jsx("span",{className:"inline-flex items-center rounded-full px-2.5 py-1 sm:px-3 sm:py-1.5 text-xs sm:text-sm font-medium bg-blue-100 text-blue-700 ring-1 ring-inset ring-blue-200",children:"Images"})})]})]})]}),m&&t.jsx("p",{className:"-mt-6 mb-8 text-sm text-red-600 text-center",role:"alert",children:m})]})}function K(s){return s.replace(/([A-Z])/g," $1").toUpperCase()}function W(s){if(s==null)return"-";if(typeof s=="string"){const m=s.trim();return m.length?m:"-"}return String(s)}function re(s){return s==null?!1:typeof s=="string"?s.trim().length>0:!0}function je({result:s,onRemove:m}){const[e,a]=U.useState(new Set),[n,i]=U.useState(new Set),[r,u]=U.useState(""),[f,c]=U.useState(!1),[d,l]=U.useState(!1);U.useEffect(()=>{if(!d)return;const p=y=>{y.key==="Escape"&&l(!1)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[d]);const h={author:"AUTHOR FOUND",creator:"CREATOR FOUND",lastModifiedBy:"LAST MODIFIED BY FOUND"},o=p=>{a(y=>{const O=new Set(y);return O.has(p)?O.delete(p):O.add(p),O})},x=U.useMemo(()=>{const p=new Set(Array.from(e).map(y=>h[y]).filter(Boolean));return(s.potentialIssues||[]).filter(y=>!p.has(y.type))},[e,s.potentialIssues]),g=s.fileName.toLowerCase(),j=String(s.metadata.fileType||""),v=g.endsWith(".jpg")||g.endsWith(".jpeg")||g.endsWith(".png")||g.endsWith(".svg")||g.endsWith(".tif")||g.endsWith(".tiff")||j.toLowerCase().includes("image"),N=v?{icon:"image",color:"text-gray-500"}:g.endsWith(".ppt")||g.endsWith(".pptx")||j.toLowerCase().includes("powerpoint")?{icon:"slideshow",color:"text-gray-500"}:g.endsWith(".xlsx")||g.endsWith(".xls")||j.toLowerCase().includes("excel")||j.toLowerCase().includes("sheet")?{icon:"table",color:"text-gray-500"}:g.endsWith(".json")?{icon:"code",color:"text-gray-500"}:g.endsWith(".csv")||g.endsWith(".md")||g.endsWith(".markdown")?{icon:"text_snippet",color:"text-gray-500"}:{icon:"description",color:"text-gray-500"},F=p=>{const y=(p||"").trim();return y?/^[a-zA-Z][a-zA-Z0-9+.-]*:\/\//.test(y)?y:/^\/\//.test(y)?`https:${y}`:`https://${y}`:"#"};return t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[t.jsxs("div",{className:"p-4 flex items-center justify-between bg-gray-50 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[v&&s.previewUrl?t.jsxs("div",{className:"relative group h-10 w-10 shrink-0",onClick:()=>l(!0),title:"Click to preview",children:[t.jsx("img",{src:s.previewUrl,alt:s.fileName,className:"h-10 w-10 rounded-md object-cover border border-gray-200 cursor-pointer",loading:"lazy"}),t.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-md bg-black/30 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:t.jsx("span",{"aria-hidden":!0,className:"material-symbols-outlined text-white text-base",children:"open_in_full"})})]}):t.jsx("span",{"aria-hidden":!0,className:`material-symbols-outlined ${N.color}`,children:N.icon}),t.jsx("h2",{className:"font-medium text-gray-800 truncate",title:s.fileName,children:s.fileName})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[s.previewUrl&&!v&&t.jsxs("div",{className:"relative group h-10 w-10",onClick:()=>l(!0),title:"Click to preview",children:[t.jsx("img",{src:s.previewUrl,alt:s.fileName,className:"h-10 w-10 rounded-md object-cover border border-gray-200 cursor-pointer",loading:"lazy"}),t.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-md bg-black/30 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:t.jsx("span",{"aria-hidden":!0,className:"material-symbols-outlined text-white text-base",children:"open_in_full"})})]}),m&&t.jsx("button",{type:"button",onClick:m,"aria-label":`Remove ${s.fileName}`,title:"Remove",className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-500 cursor-pointer",children:t.jsx("span",{"aria-hidden":!0,className:"material-symbols-outlined",children:"delete"})})]})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[!!x.length&&t.jsx("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx("span",{"aria-hidden":!0,className:"material-symbols-outlined text-red-600 mr-3",children:"error"}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-red-800",children:`Potential Issues (${x.length})`}),t.jsx("div",{className:"mt-1 space-y-1 text-sm text-red-700",children:x.map((p,y)=>t.jsxs("div",{className:"break-words",children:[t.jsx("span",{className:"font-semibold",children:p.type}),": ",p.value]},y))})]})]})}),(()=>{const p=s.contentFindings,y=s.metadata.emailsFound,O=s.metadata.urlsFound,C=(p?.emails?.length??0)||(y?.length??0),S=(p?.urls?.length??0)||(O?.length??0);return C>0||S>0?t.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx("span",{"aria-hidden":!0,className:"material-symbols-outlined text-blue-600 mr-3",children:"lightbulb"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Review Suggested"}),t.jsx("p",{className:"text-sm text-blue-700",children:`Found ${C} email${C===1?"":"s"} and ${S} URL${S===1?"":"s"} in the content. Please review details below.`})]})]})}):null})(),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Metadata"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:(()=>{const p=["author","creator","lastModifiedBy"],y=["wordCount","words","totalTime","exif"],O=["words","slides","pages","numberOfSheets"],C=["creationDate","modificationDate"],S=["emailsFound","urlsFound"],T=Object.entries(s.metadata),M=A=>Object.prototype.hasOwnProperty.call(s.metadata,A),I=T.filter(([A])=>!p.includes(A)&&!O.includes(A)&&!C.includes(A)&&!S.includes(A)&&!y.includes(A));return t.jsxs(t.Fragment,{children:[p.map(A=>{const L=s.metadata[A],_=(A==="author"||A==="creator"||A==="lastModifiedBy")&&re(L),H=e.has(A),Z=_&&!H;return t.jsx("div",{className:`bg-gray-50 p-4 rounded-xl border border-gray-200 ${Z?"ring-2 ring-red-200":""}`,children:t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("p",{className:"text-gray-500 font-semibold text-xs sm:text-sm",children:K(String(A))}),t.jsx("p",{className:"text-gray-800 text-xs sm:text-sm line-clamp-2",title:W(L),children:W(L)})]}),_&&t.jsx("div",{className:"shrink-0",children:H?t.jsx("button",{type:"button",onClick:()=>o(A),className:"text-xs sm:text-[0.8125rem] text-gray-600 hover:text-gray-800 underline underline-offset-2 cursor-pointer",children:"Flag"}):t.jsx("button",{type:"button",onClick:()=>o(A),className:"text-xs sm:text-[0.8125rem] text-red-700 hover:text-red-800 underline underline-offset-2 cursor-pointer",children:"Dismiss"})})]})},`priority-${A}`)}),O.filter(A=>M(A)&&!y.includes(A)).map(A=>{const L=s.metadata[A];return t.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-200",children:[t.jsx("p",{className:"text-gray-500 font-semibold text-xs sm:text-sm",children:K(String(A))}),t.jsx("p",{className:"text-gray-800 text-xs sm:text-sm line-clamp-2",title:W(L),children:W(L)})]},`count-${A}`)}),C.filter(M).map(A=>{const L=s.metadata[A];return t.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-200",children:[t.jsx("p",{className:"text-gray-500 font-semibold text-xs sm:text-sm",children:K(String(A))}),t.jsx("p",{className:"text-gray-800 text-xs sm:text-sm line-clamp-2",title:W(L),children:W(L)})]},`date-${A}`)}),I.map(([A,L])=>{const _=(A==="author"||A==="creator"||A==="lastModifiedBy")&&re(L);return t.jsxs("div",{className:`bg-gray-50 p-4 rounded-xl border border-gray-200 ${_?"ring-2 ring-red-200":""}`,children:[t.jsx("p",{className:"text-gray-500 font-semibold text-xs sm:text-sm",children:K(A)}),t.jsx("p",{className:"text-gray-800 text-xs sm:text-sm line-clamp-2",title:W(L),children:W(L)})]},A)})]})})()})]}),null,d&&s.previewUrl&&t.jsx("div",{className:"fixed inset-0 z-50 bg-black/75 flex items-center justify-center p-4",role:"dialog","aria-modal":"true",onClick:()=>l(!1),children:t.jsxs("div",{className:"relative max-w-full max-h-full",onClick:p=>p.stopPropagation(),children:[t.jsx("img",{src:s.previewUrl,alt:s.fileName,className:"max-w-[95vw] max-h-[85vh] object-contain rounded-lg shadow-2xl bg-white"}),t.jsx("button",{type:"button",onClick:()=>l(!1),"aria-label":"Close preview",className:"absolute -top-3 -right-3 bg-white text-gray-700 rounded-full shadow-md border border-gray-200 hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-500 flex items-center justify-center h-9 w-9",children:t.jsx("span",{"aria-hidden":"true",className:"material-symbols-outlined text-base",children:"close"})})]})}),(()=>{const p=s.contentFindings,y=p&&((p.emails?.length??0)>0||(p.urls?.length??0)>0),O=s.metadata.emailsFound,C=s.metadata.urlsFound;if(y){const S=[...(p.emails||[]).map(w=>({type:"Email",value:w.value,pages:w.pages})),...(p.urls||[]).map(w=>({type:"URL",value:w.value,pages:w.pages}))],T=String(s.metadata.fileType||"").toUpperCase(),M=T==="JSON"||T==="MARKDOWN"||T==="CSV",I=s.fileName.toLowerCase(),A=T==="PDF"||I.endsWith(".pdf"),L=T.includes("MICROSOFT WORD DOCUMENT")||I.endsWith(".docx")||I.endsWith(".doc"),_=T.includes("POWERPOINT")||I.endsWith(".pptx")||I.endsWith(".ppt"),H=M?"Line":A||L?"Page(s)":_?"Slide(s)":"Pages",Z=(w,E)=>{try{if(w==="Email"){const R=E.lastIndexOf("@");return R!==-1?E.slice(R+1).trim().toLowerCase():""}let P="";try{P=new URL(E).hostname}catch{P=E.match(/^[a-zA-Z]+:\/\/(?:[^@\n]+@)?([^\/:?#\n]+)/)?.[1]||""}return P=P.trim().toLowerCase(),P.startsWith("www.")&&(P=P.slice(4)),P}catch{return""}},ce=S.map(w=>Z(w.type,w.value)).filter(w=>w.length>0),le=Array.from(new Set(ce)).sort((w,E)=>w.localeCompare(E)),ae=r?S.filter(w=>{const E=Z(w.type,w.value);return E===r||E.endsWith(`.${r}`)}):S;return t.jsxs("div",{className:"mb-2",children:[t.jsx("div",{className:"my-4 h-px bg-gray-200"}),t.jsxs("div",{className:"mb-2 flex items-center justify-between gap-3",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Content Findings"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{htmlFor:"domain-filter",className:"text-xs text-gray-600",children:"Filter by domain"}),t.jsxs("select",{id:"domain-filter",value:r,onChange:w=>u(w.target.value),className:"text-xs rounded-md border border-gray-300 bg-white px-2 py-1 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All domains"}),le.map(w=>t.jsx("option",{value:w,children:w},w))]})]})]}),t.jsx("div",{className:"md:hidden space-y-2",children:ae.map((w,E)=>{const P=`${w.type}:${w.value}:${w.pages.join("|")}`,R=n.has(P),Y=()=>i(q=>{const B=new Set(q);return B.has(P)?B.delete(P):B.add(P),B});return t.jsx("div",{className:`bg-white rounded-lg border border-gray-200 p-3 ${R?"opacity-70":""}`,role:"listitem",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("input",{type:"checkbox","aria-label":`Mark ${w.type} ${w.value} as reviewed`,checked:R,onChange:Y,className:"mt-0.5 h-4 w-4 shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:`text-[10px] font-semibold tracking-wide uppercase ${R?"text-gray-400 line-through":"text-gray-700"}`,children:w.type}),t.jsxs("span",{className:`text-[10px] text-gray-500 ${R?"line-through":""}`,children:["• ",H,": ",w.pages.join(", ")]})]}),t.jsx("div",{className:`text-xs break-words ${R?"text-gray-400 line-through":"text-blue-700"}`,children:w.type==="URL"?t.jsx("a",{href:F(w.value),target:"_blank",rel:"noopener noreferrer",className:`${R?"pointer-events-none":"hover:underline"} break-words`,children:w.value}):w.value})]})]})},E)})}),t.jsx("div",{className:"hidden md:block overflow-x-auto rounded-xl border border-gray-200",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-2 w-10 text-left text-xs font-semibold text-gray-600","aria-label":"Reviewed",title:"Reviewed",children:" "}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Type"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Value"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:H})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:ae.map((w,E)=>{const P=`${w.type}:${w.value}:${w.pages.join("|")}`,R=n.has(P),Y=()=>i(q=>{const B=new Set(q);return B.has(P)?B.delete(P):B.add(P),B});return t.jsxs("tr",{children:[t.jsx("td",{className:"px-3 py-2 align-top",children:t.jsx("input",{type:"checkbox","aria-label":`Mark ${w.type} ${w.value} as reviewed`,checked:R,onChange:Y,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),t.jsx("td",{className:`px-4 py-2 text-xs whitespace-nowrap ${R?"text-gray-400 line-through":"text-gray-800"}`,children:w.type}),t.jsx("td",{className:`px-4 py-2 text-xs break-all ${R?"text-gray-400 line-through":"text-blue-700"}`,children:w.type==="URL"?t.jsx("a",{href:F(w.value),target:"_blank",rel:"noopener noreferrer",className:`${R?"pointer-events-none":"hover:underline"} break-all`,title:w.value,children:w.value}):w.value}),t.jsx("td",{className:`px-4 py-2 text-xs whitespace-nowrap ${R?"text-gray-400 line-through":"text-gray-700"}`,children:w.pages.join(", ")})]},E)})})]})})]})}return!O&&!C?null:t.jsxs("div",{className:"mb-2",children:[t.jsx("div",{className:"my-4 h-px bg-gray-200"}),t.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Content Findings"}),t.jsxs("div",{className:"space-y-4",children:[!!O?.length&&t.jsxs("div",{className:"w-full bg-yellow-50 p-4 rounded-xl border border-yellow-200",children:[t.jsx("p",{className:"text-yellow-800 font-semibold text-xs sm:text-sm mb-2",children:"Emails Found"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:O.map((S,T)=>t.jsx("span",{className:"text-xs sm:text-sm bg-white text-yellow-800 border border-yellow-200 rounded-md px-2 py-1 break-all",children:S},T))})]}),!!C?.length&&t.jsxs("div",{className:"w-full bg-blue-50 p-4 rounded-xl border border-blue-200",children:[t.jsx("p",{className:"text-blue-800 font-semibold text-xs sm:text-sm mb-2",children:"URLs Found"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:C.map((S,T)=>t.jsx("a",{href:F(S),target:"_blank",rel:"noopener noreferrer",className:"text-xs sm:text-sm bg-white text-blue-800 border border-blue-200 rounded-md px-2 py-1 break-all hover:underline",title:S,children:S},T))})]})]})]})})()]})]})}function Ne({results:s,onClear:m,onRemove:e}){return t.jsxs("div",{className:"space-y-6",role:"status",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Results (",s.length,")"]}),t.jsxs("button",{onClick:m,className:"text-gray-700 hover:text-gray-900 font-medium flex items-center gap-2 py-2 px-4 rounded-lg border border-gray-300 bg-white shadow-sm hover:bg-gray-50 transition w-full sm:w-auto min-h-11 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-gray-500",children:[t.jsx("span",{"aria-hidden":!0,className:"material-symbols-outlined",children:"delete_sweep"}),"Clear Results"]})]}),t.jsx("div",{className:"space-y-8",children:s.map((a,n)=>t.jsx(je,{result:a,onRemove:()=>e(n)},n))})]})}function k(s){return typeof s=="string"&&/latex/i.test(s)}pe.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${fe}/pdf.worker.mjs`;async function ve(s){const m=await s.arrayBuffer(),e=await ue(m).promise,a=await e.getMetadata(),n={fileName:s.name,metadata:{pages:e.numPages}},i=[];if(a.info){const r=a.info,u=typeof r.Author=="string"?r.Author.trim():"",f=typeof r.Creator=="string"?r.Creator.trim():"";u&&!k(u)&&i.push({type:"AUTHOR FOUND",value:u}),f&&!k(f)&&i.push({type:"CREATOR FOUND",value:f}),n.metadata.title=r.Title,n.metadata.author=r.Author,n.metadata.subject=r.Subject,n.metadata.creator=r.Creator,n.metadata.producer=r.Producer,n.metadata.creationDate=r.CreationDate,n.metadata.modificationDate=r.ModDate}try{const r=new Map,u=new Map;for(let d=1;d<=e.numPages;d++){const o=((await(await e.getPage(d)).getTextContent()).items||[]).map(x=>typeof x.str=="string"?x.str:"").join(" ");$(o,(x,g)=>{g==="email"?(r.has(x)||r.set(x,new Set),r.get(x).add(d)):(u.has(x)||u.set(x,new Set),u.get(x).add(d))})}const f=Array.from(r.keys()),c=Array.from(u.keys());f.length&&(n.metadata.emailsFound=f),c.length&&(n.metadata.urlsFound=c),(f.length||c.length)&&(n.contentFindings={emails:f.map(d=>({value:d,pages:Array.from(r.get(d)).sort((l,h)=>l-h)})),urls:c.map(d=>({value:d,pages:Array.from(u.get(d)).sort((l,h)=>l-h)}))})}catch(r){console.warn("PDF text extraction skipped:",r)}return i.length&&(n.potentialIssues=i),n}function $(s,m){const a=(h=>{let o=h;return o=o.replace(/(https?|ftp)\s*:\s*\/\s*\//gi,"$1://"),o=o.replace(/\b(https?|ftp)\s*:\s*/gi,"$1:"),o=o.replace(/([A-Za-z0-9%~_+\-])\s*\.\s*([A-Za-z0-9%~_+\-])/g,"$1.$2"),o=o.replace(/([A-Za-z0-9%~_+\-.])\s*\/\s*([A-Za-z0-9%~_+\-.])/g,"$1/$2"),o=o.replace(/\?\s*/g,"?"),o=o.replace(/&\s*/g,"&"),o=o.replace(/=\s*/g,"="),o=o.replace(/#\s*/g,"#"),o})(s),n=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z]{2,63})/gi,i=new RegExp(n.source,"i"),r=[/(https?:\/\/|ftp:\/\/)[^\s<>"'`{}|\\^\[\]]+/gi,/\bwww\.[A-Za-z0-9.-]+(?:\/[^^\s<>"'`{}|\\\[\]]*)?/gi,/\b(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+(?:[a-z]{2,63})(?:\/[^^\s<>"'`{}|\\\[\]]*)?/gi],u=h=>{let o=h.trim();const x=g=>o.match(g)?.length??0;for(;o.length;){const g=o[o.length-1];if(g===")"){const j=x(/\(/g);if(x(/\)/g)>j){o=o.slice(0,-1);continue}}if(/[.,;:!?…'"”’›»)\]]/.test(g)){o=o.slice(0,-1);continue}break}return o};let f;for(;(f=n.exec(a))!==null;)m(u(f[0]),"email");const d=["com","org","net","edu","gov","mil","int","io","co","me","ai","app","dev","tech","xyz","info","biz","online","site","shop","blog","news","art","tv","fm","gg","ly","to","la","us","uk","de","fr","es","it","nl","be","at","ch","se","no","fi","dk","pl","cz","sk","hu","ro","bg","gr","pt","ie","is","tr","ru","ua","by","kz","ca","mx","br","ar","cl","pe","uy","au","nz","za","in","sg","hk","tw","jp","kr","cn","vn","th","my","id","ph","sa","ae","qa","kw","bh","om","il"].join("|"),l=h=>{const o=h.match(new RegExp(`^(?:(?:https?:\\/\\/|ftp:\\/\\/\\/)|(?:www\\.))?[A-Za-z0-9-]+(?:\\.[A-Za-z0-9-]+)*\\.(?:${d})(?:\\/[^\\s<>"'\`{}|\\\\\\[\\\\\\]]*)?`,"i"));return o?o[0]:null};for(const h of r){let o;for(;(o=h.exec(a))!==null;){const x=u(o[0]);if(i.test(x))continue;let g=l(x);if(!g||!/^https?:\/\//i.test(g)&&!/^ftp:\/\//i.test(g)&&!/^www\./i.test(g)&&!g.includes("/"))continue;const v=g.lastIndexOf("/"),b=g.slice(v+1);/\.[A-Z][a-zA-Z]+$/.test(b)&&(g=g.slice(0,g.lastIndexOf("."))),m(g,"url")}}}async function Se(s){const m=await s.arrayBuffer(),e={fileName:s.name,metadata:{fileType:"Microsoft Word Document"}};try{try{const i=await ie(m);Object.assign(e.metadata,i);const r=typeof i.author=="string"?i.author.trim():"",u=typeof i.creator=="string"?i.creator.trim():"",f=typeof i.lastModifiedBy=="string"?i.lastModifiedBy.trim():"",c=[];r&&!k(r)&&c.push({type:"AUTHOR FOUND",value:r}),u&&!k(u)&&c.push({type:"CREATOR FOUND",value:u}),f&&!k(f)&&c.push({type:"LAST MODIFIED BY FOUND",value:f}),c.length&&(e.potentialIssues=c)}catch(i){console.warn("DOCX metadata extraction skipped:",i)}const n=(await he.extractRawText({arrayBuffer:m})).value||"";try{const i=new Set,r=new Set;$(n,(c,d)=>{d==="email"?i.add(c):r.add(c)});const u=Array.from(i.keys()),f=Array.from(r.keys());u.length&&(e.metadata.emailsFound=u),f.length&&(e.metadata.urlsFound=f),(u.length||f.length)&&(e.contentFindings={emails:u.map(c=>({value:c,pages:[1]})),urls:f.map(c=>({value:c,pages:[1]}))})}catch(i){console.warn("DOCX content scan skipped:",i)}}catch(a){console.error("Error parsing docx:",a),e.metadata.error="Could not parse .docx file (only .docx supported)"}return e}async function Ae(s){const m=await s.arrayBuffer(),e=ge(m,{type:"array"}),a=e.Props,n={fileName:s.name,metadata:{sheetNames:e.SheetNames.join(", "),numberOfSheets:e.SheetNames.length}};if(a){const i=typeof a.Author=="string"?a.Author.trim():"",r=typeof a.Creator=="string"?a.Creator.trim():"",u=typeof a.LastAuthor=="string"?a.LastAuthor.trim():"",f=[];i&&!k(i)&&f.push({type:"AUTHOR FOUND",value:i}),r&&!k(r)&&f.push({type:"CREATOR FOUND",value:r}),u&&!k(u)&&f.push({type:"LAST MODIFIED BY FOUND",value:u}),f.length&&(n.potentialIssues=f),n.metadata.title=a.Title,n.metadata.author=a.Author,n.metadata.subject=a.Subject,n.metadata.creator=a.Creator,n.metadata.company=a.Company,n.metadata.lastModifiedBy=a.LastAuthor,n.metadata.creationDate=a.CreatedDate?.toISOString?.(),n.metadata.modificationDate=a.ModifiedDate?.toISOString?.()}try{const i=new Map,r=new Map;e.SheetNames.forEach((d,l)=>{const h=l+1,o=e.Sheets[d];if(o)for(const x of Object.keys(o)){if(x.startsWith("!"))continue;const g=o[x],j=typeof g?.w=="string"&&g.w||typeof g?.v=="string"&&g.v||"";j&&$(String(j),(b,N)=>{N==="email"?(i.has(b)||i.set(b,new Set),i.get(b).add(h)):(r.has(b)||r.set(b,new Set),r.get(b).add(h))});const v=g?.l?.Target;if(v)if(/^mailto:/i.test(v)){const b=decodeURIComponent(v.replace(/^mailto:/i,"").split("?")[0]);b&&(i.has(b)||i.set(b,new Set),i.get(b).add(h))}else $(String(v),(b,N)=>{N==="email"?(i.has(b)||i.set(b,new Set),i.get(b).add(h)):(r.has(b)||r.set(b,new Set),r.get(b).add(h))})}});const f=Array.from(i.keys()),c=Array.from(r.keys());f.length&&(n.metadata.emailsFound=f),c.length&&(n.metadata.urlsFound=c),(f.length||c.length)&&(n.contentFindings={emails:f.map(d=>({value:d,pages:Array.from(i.get(d)).sort((l,h)=>l-h)})),urls:c.map(d=>({value:d,pages:Array.from(r.get(d)).sort((l,h)=>l-h)}))})}catch(i){console.warn("XLSX content scan skipped:",i)}return n}async function Oe(s){const m=await s.arrayBuffer(),e={fileName:s.name,metadata:{fileType:"Microsoft PowerPoint Presentation"}};try{const a=await ie(m);Object.assign(e.metadata,a);const n=typeof a.author=="string"?a.author.trim():"",i=typeof a.creator=="string"?a.creator.trim():"",r=typeof a.lastModifiedBy=="string"?a.lastModifiedBy.trim():"",u=[];n&&!k(n)&&u.push({type:"AUTHOR FOUND",value:n}),i&&!k(i)&&u.push({type:"CREATOR FOUND",value:i}),r&&!k(r)&&u.push({type:"LAST MODIFIED BY FOUND",value:r}),u.length&&(e.potentialIssues=u)}catch(a){console.warn("PPTX metadata extraction failed:",a),e.metadata.note="Could not extract .pptx metadata"}try{const a=await ne.loadAsync(m),n=new Map,i=new Map,r=Object.keys(a.files).map(c=>{const d=c.match(/^ppt\/slides\/slide(\d+)\.xml$/i);return d?{path:c,num:Number(d[1])}:null}).filter(c=>!!c).sort((c,d)=>c.num-d.num);for(const{path:c,num:d}of r){const l=await J(a,c);if(l){const x=X(l),g=Array.from(x.getElementsByTagName("*")),j=[];for(const b of g)if(b.localName==="t"){const N=(b.textContent||"").trim();N&&j.push(N)}const v=j.join(" ");v&&$(v,(b,N)=>{N==="email"?(n.has(b)||n.set(b,new Set),n.get(b).add(d)):(i.has(b)||i.set(b,new Set),i.get(b).add(d))})}const h=c.replace(/slides\/slide(\d+)\.xml$/i,"slides/_rels/slide$1.xml.rels"),o=await J(a,h);if(o){const x=X(o),g=Array.from(x.getElementsByTagName("Relationship"));for(const j of g){const v=j.getAttribute("Type")||"";if(!/\/hyperlink$/i.test(v))continue;const b=j.getAttribute("Target")||"";if(b)if(/^mailto:/i.test(b)){const N=decodeURIComponent(b.replace(/^mailto:/i,"").split("?")[0]);N&&(n.has(N)||n.set(N,new Set),n.get(N).add(d))}else $(b,(N,F)=>{F==="email"?(n.has(N)||n.set(N,new Set),n.get(N).add(d)):(i.has(N)||i.set(N,new Set),i.get(N).add(d))})}}}const u=Array.from(n.keys()),f=Array.from(i.keys());u.length&&(e.metadata.emailsFound=u),f.length&&(e.metadata.urlsFound=f),(u.length||f.length)&&(e.contentFindings={emails:u.map(c=>({value:c,pages:Array.from(n.get(c)).sort((d,l)=>d-l)})),urls:f.map(c=>({value:c,pages:Array.from(i.get(c)).sort((d,l)=>d-l)}))})}catch(a){console.warn("PPTX content scan skipped:",a)}return e}async function Ce(s){switch(s.name.split(".").pop()?.toLowerCase()){case"csv":return Fe(s);case"md":case"markdown":return De(s);case"json":return Te(s);case"pdf":return ve(s);case"docx":return Se(s);case"doc":return{fileName:s.name,metadata:{error:"Legacy .doc format not supported. Please convert to .docx."}};case"xlsx":return Ae(s);case"xls":return{fileName:s.name,metadata:{error:"Legacy .xls format not supported. Please convert to .xlsx."}};case"pptx":return Oe(s);case"ppt":return{fileName:s.name,metadata:{error:"Legacy .ppt format not supported. Please convert to .pptx."}};case"jpg":case"jpeg":return Me(s);case"png":return Ue(s);case"svg":return Ee(s);case"tif":case"tiff":return $e(s);default:return{fileName:s.name,metadata:{error:"Unsupported file type"}}}}async function Fe(s){const m=await s.text(),e={fileName:s.name,metadata:{fileType:"CSV"}};try{const a=m.split(/\r?\n/),n=a.filter(p=>p.trim().length>0).slice(0,20),i=[{char:",",name:"comma"},{char:"	",name:"tab"},{char:";",name:"semicolon"},{char:"|",name:"pipe"}];let r=i[0],u=-1;for(const p of i){const y=n.map(T=>(T.match(new RegExp(ke(p.char),"g"))||[]).length),O=y.reduce((T,M)=>T+M,0),C=y.length?Pe(y):0,S=O-C;S>u&&(u=S,r=p)}const f=r.char;e.metadata.delimiter=r.name;const c=[];for(const p of a){const y=Re(p,f);y.length===1&&y[0]===""&&p.trim()===""||c.push(y)}const d=c.length,l=c.reduce((p,y)=>Math.max(p,y.length),0),h=c.length>0&&c[0].some(p=>/[A-Za-z]/.test(p));e.metadata.headerRowPresent=h,e.metadata.numberOfRows=Math.max(0,d-(h?1:0)),e.metadata.numberOfColumns=l,h&&(e.metadata.headers=c[0]);const x=(h?c.slice(1):c).slice(0,50),g=p=>{const y=p.trim();return y?/^(true|false)$/i.test(y)?"boolean":/^[+-]?\d+(?:\.\d+)?$/.test(y)?"number":/^\d{4}-\d{2}-\d{2}(?:[ T]\d{2}:\d{2}(?::\d{2})?)?/.test(y)||/^\d{1,2}[\/.-]\d{1,2}[\/.-]\d{2,4}$/.test(y)?"date":"string":"empty"},j=[];for(let p=0;p<l;p++){const y={number:0,boolean:0,date:0,string:0,empty:0};for(const C of x){const S=g(C[p]??"");y[S]++}const O=Object.entries(y).sort((C,S)=>S[1]-C[1])[0][0];j.push(O)}e.metadata.columnTypes=j;const v=new Map,b=new Map;c.forEach((p,y)=>{const O=y+1,C=p.join(" ");C.trim()&&$(C,(S,T)=>{T==="email"?(v.has(S)||v.set(S,new Set),v.get(S).add(O)):(b.has(S)||b.set(S,new Set),b.get(S).add(O))})});const N=Array.from(v.keys()),F=Array.from(b.keys());N.length&&(e.metadata.emailsFound=N),F.length&&(e.metadata.urlsFound=F),(N.length||F.length)&&(e.contentFindings={emails:N.map(p=>({value:p,pages:Array.from(v.get(p)).sort((y,O)=>y-O)})),urls:F.map(p=>({value:p,pages:Array.from(b.get(p)).sort((y,O)=>y-O)}))})}catch(a){console.warn("CSV parse warning:",a),e.metadata.error="Could not parse CSV content"}return e}async function De(s){const m=await s.text(),e={fileName:s.name,metadata:{fileType:"Markdown"}};try{const a=Le(m);if(a){const{data:o}=a;o.title&&(e.metadata.title=String(o.title)),o.description&&(e.metadata.description=String(o.description)),o.date&&(e.metadata.creationDate=z(String(o.date))||String(o.date)),o.tags&&(e.metadata.tags=Array.isArray(o.tags)?o.tags:String(o.tags)),o.category&&(e.metadata.category=String(o.category));let x=[];Array.isArray(o.authors)?x=o.authors.map(j=>String(j)):o.author&&(Array.isArray(o.author)?x=o.author.map(j=>String(j)):x=[String(o.author)]),x.length&&(e.metadata.author=x.length===1?x[0]:x);const g=[];for(const j of x){const v=j.trim();v&&!k(v)&&g.push({type:"AUTHOR FOUND",value:v})}g.length&&(e.potentialIssues=g)}if(!e.metadata.title){const o=m.match(/^\s*#\s+(.+)$/m);o&&(e.metadata.title=o[1].trim())}const n=m.trim().split(/\s+/).filter(Boolean).length;e.metadata.wordCount=n;const i=(m.match(/^\s*#{1,6}\s+/gm)||[]).length,r=(m.match(/\[[^\]]*\]\([^\)]+\)/g)||[]).length,u=(m.match(/!\[[^\]]*\]\([^\)]+\)/g)||[]).length;e.metadata.headingCount=i,e.metadata.linkCount=r,e.metadata.imageCount=u;const f=new Map,c=new Map;m.split(/\r?\n/).forEach((o,x)=>{const g=x+1;if(!o.trim())return;$(o,(N,F)=>{F==="email"?(f.has(N)||f.set(N,new Set),f.get(N).add(g)):(c.has(N)||c.set(N,new Set),c.get(N).add(g))});const j=/!?\[[^\]]*\]\(([^)\s]+)(?:\s+"[^"]*")?\)/g;let v;for(;(v=j.exec(o))!==null;){const N=v[1];$(N,(F,p)=>{p==="email"?(f.has(F)||f.set(F,new Set),f.get(F).add(g)):(c.has(F)||c.set(F,new Set),c.get(F).add(g))})}const b=o.match(/^\s*\[[^\]]+\]:\s+(\S+)/);if(b){const N=b[1];$(N,(F,p)=>{p==="email"?(f.has(F)||f.set(F,new Set),f.get(F).add(g)):(c.has(F)||c.set(F,new Set),c.get(F).add(g))})}});const l=Array.from(f.keys()),h=Array.from(c.keys());l.length&&(e.metadata.emailsFound=l),h.length&&(e.metadata.urlsFound=h),(l.length||h.length)&&(e.contentFindings={emails:l.map(o=>({value:o,pages:Array.from(f.get(o)).sort((x,g)=>x-g)})),urls:h.map(o=>({value:o,pages:Array.from(c.get(o)).sort((x,g)=>x-g)}))})}catch(a){console.warn("Markdown parse warning:",a),e.metadata.error="Could not parse Markdown content"}return e}async function Te(s){const m=await s.text(),e={fileName:s.name,metadata:{fileType:"JSON"}};try{const a=JSON.parse(m),n=Array.isArray(a);if(e.metadata.topLevelType=n?"array":typeof a,n)e.metadata.arrayLength=a.length;else if(a&&typeof a=="object"){const p=Object.keys(a);e.metadata.topLevelKeys=p,e.metadata.topLevelKeyCount=p.length}const i={string:0,number:0,boolean:0,null:0,object:0,array:0};let r=0;const u=[],f=[],c=[],d=[],l=(p,y,O)=>{if(y>r&&(r=y),p===null){i.null++;return}const C=Array.isArray(p)?"array":typeof p;if(C==="array"?i.array++:C==="object"?i.object++:C==="string"?i.string++:C==="number"?i.number++:C==="boolean"&&i.boolean++,C==="object")for(const[S,T]of Object.entries(p)){const M=S.toLowerCase(),I=O+"/"+S.replace(/~/g,"~0").replace(/\//g,"~1");typeof T=="string"&&((M==="author"||M.endsWith("author"))&&f.push(T),(M==="creator"||M.endsWith("creator"))&&c.push(T),(M==="lastmodifiedby"||M==="modifiedby"||M==="last_modified_by")&&d.push(T)),l(T,y+1,I)}else C==="array"&&p.forEach((S,T)=>l(S,y+1,O+"/"+T))};l(a,0,""),e.metadata.maxDepth=r,e.metadata.typeCounts=i;const h=p=>Array.from(new Set(p.map(y=>y.trim()).filter(Boolean))),o=h(f),x=h(c),g=h(d);o.length&&(e.metadata.author=o.length===1?o[0]:o),x.length&&(e.metadata.creator=x.length===1?x[0]:x),g.length&&(e.metadata.lastModifiedBy=g.length===1?g[0]:g);for(const p of o)k(p)||u.push({type:"AUTHOR FOUND",value:p});for(const p of x)k(p)||u.push({type:"CREATOR FOUND",value:p});for(const p of g)k(p)||u.push({type:"LAST MODIFIED BY FOUND",value:p});u.length&&(e.potentialIssues=u);const j=new Map,v=new Map;m.split(/\r?\n/).forEach((p,y)=>{const O=y+1;p.trim()&&$(p,(C,S)=>{S==="email"?(j.has(C)||j.set(C,new Set),j.get(C).add(O)):(v.has(C)||v.set(C,new Set),v.get(C).add(O))})});const N=Array.from(j.keys()),F=Array.from(v.keys());N.length&&(e.metadata.emailsFound=N),F.length&&(e.metadata.urlsFound=F),(N.length||F.length)&&(e.contentFindings={emails:N.map(p=>({value:p,pages:Array.from(j.get(p)).sort((y,O)=>y-O)})),urls:F.map(p=>({value:p,pages:Array.from(v.get(p)).sort((y,O)=>y-O)}))})}catch(a){console.warn("JSON parse warning:",a),e.metadata.error="Invalid JSON"}return e}function ke(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Pe(s){if(!s.length)return 0;const m=s.reduce((e,a)=>e+a,0)/s.length;return s.reduce((e,a)=>e+Math.pow(a-m,2),0)/s.length}function Re(s,m){const e=[];let a="",n=!1;for(let i=0;i<s.length;i++){const r=s[i];if(n){if(r==='"'){if(i+1<s.length&&s[i+1]==='"'){a+='"',i++;continue}n=!1;continue}a+=r}else r==='"'?n=!0:r===m?(e.push(a),a=""):a+=r}return e.push(a),e.map(i=>i.trim())}function Le(s){const m=s.match(/^---\r?\n([\s\S]*?)\r?\n---\r?\n/);if(!m)return null;const e=m[1],a=s.slice(m[0].length),n={},i=e.split(/\r?\n/);let r=null;for(const u of i){const f=u.trim();if(!f||f.startsWith("#"))continue;if(r&&/^-\s+/.test(f)){(n[r]=n[r]||[]).push(f.replace(/^-\s+/,""));continue}r=null;const c=f.match(/^(\w[\w-]*)\s*:\s*(.*)$/);if(!c)continue;const d=c[1];let l=c[2].trim();if(!(l===""||l==="|"||l===">")){if(l.startsWith('"')&&l.endsWith('"')||l.startsWith("'")&&l.endsWith("'"))l=l.slice(1,-1);else if(l.startsWith("[")&&l.endsWith("]")){const h=l.slice(1,-1).split(",").map(o=>o.trim()).filter(Boolean);n[d]=h;continue}else if(l==="[]"){n[d]=[];continue}else if(l===null||l==="null"){n[d]=null;continue}else if(/^\d{4}-\d{2}-\d{2}/.test(l)){n[d]=l;continue}else if(/^(true|false)$/i.test(l)){n[d]=/^true$/i.test(l);continue}else if(/^\d+(?:\.\d+)?$/.test(l)){n[d]=Number(l);continue}else if(l==="|"||l===">")continue;if(l===""){r=d,n[d]=[];continue}n[d]=l}}return{data:n,body:a}}async function ie(s){const m=await ne.loadAsync(s),e=await J(m,"docProps/core.xml"),a=await J(m,"docProps/app.xml"),n={};if(e){const i=X(e),r=ee(i);r.title&&(n.title=D(r.title)),r.creator&&(n.creator=D(r.creator)),r.subject&&(n.subject=D(r.subject)),r.description&&(n.description=D(r.description)),r.keywords&&(n.keywords=D(r.keywords)),r.category&&(n.category=D(r.category)),r.lastModifiedBy&&(n.lastModifiedBy=D(r.lastModifiedBy)),r.created&&(n.creationDate=z(D(r.created))),r.modified&&(n.modificationDate=z(D(r.modified))),!n.author&&r.creator&&(n.author=D(r.creator))}if(a){const i=X(a),r=ee(i);r.Company&&(n.company=D(r.Company)),r.Manager&&(n.manager=D(r.Manager)),r.Application&&(n.application=D(r.Application)),r.AppVersion&&(n.appVersion=D(r.AppVersion)),r.Slides&&(n.slides=V(D(r.Slides))),r.Pages&&(n.pages=V(D(r.Pages))),r.Words&&(n.words=V(D(r.Words))),r.TotalTime&&(n.totalTime=V(D(r.TotalTime)))}return n}async function J(s,m){const e=s.file(m);if(!e)return null;try{return await e.async("text")}catch{return null}}function X(s){return new DOMParser().parseFromString(s,"application/xml")}function ee(s){const m=s.getElementsByTagName("*"),e={};for(let a=0;a<m.length;a++){const n=m[a],i=n.localName;i in e||(e[i]=n)}return e}function D(s){return s?(s.textContent||"").trim():""}function z(s){if(!s)return;let m=s.trim();const e=/^(\d{4}):(\d{2}):(\d{2})[ T](\d{2}):(\d{2}):(\d{2})/.exec(m);if(e){const[,n,i,r,u,f,c]=e;m=`${n}-${i}-${r}T${u}:${f}:${c}`}const a=new Date(m);return isNaN(a.getTime())?void 0:a.toISOString()}function V(s){const m=s?Number(s):NaN;return isNaN(m)?void 0:m}async function Me(s){const m=await s.arrayBuffer(),e={fileName:s.name,metadata:{fileType:"JPEG Image"}};try{const a=await se(m);Object.assign(e.metadata,a);const n=e.metadata.__exifAll;n&&Object.keys(n).length&&(e.exif=n),delete e.metadata.__exifAll;const i=te(m);if(i){const c=G(i);Object.assign(e.metadata,c)}const r=[],u=String(e.metadata.author||"").trim(),f=String(e.metadata.creator||"").trim();u&&!k(u)&&r.push({type:"AUTHOR FOUND",value:u}),f&&!k(f)&&r.push({type:"CREATOR FOUND",value:f}),r.length&&(e.potentialIssues=r)}catch(a){console.warn("JPEG parse warning:",a)}return e}async function Ue(s){const m=await s.arrayBuffer(),e={fileName:s.name,metadata:{fileType:"PNG Image"}};try{const a=await se(m);Object.assign(e.metadata,a);const n=e.metadata.__exifAll;n&&Object.keys(n).length&&(e.exif=n),delete e.metadata.__exifAll;const i=Ie(m),r={Title:"title",Description:"description",Author:"author",Software:"software",Copyright:"copyright",Source:"source",Comment:"comment","Creation Time":"creationTime"};for(const[l,h]of Object.entries(i)){const o=r[l]||l.replace(/\s+/g,"").replace(/^(.)/,x=>x.toLowerCase());e.metadata[o]=h}const u=te(m);if(u){const l=G(u);Object.assign(e.metadata,l)}const f=[],c=String(e.metadata.author||"").trim(),d=String(e.metadata.creator||"").trim();c&&!k(c)&&f.push({type:"AUTHOR FOUND",value:c}),d&&!k(d)&&f.push({type:"CREATOR FOUND",value:d}),f.length&&(e.potentialIssues=f)}catch(a){console.warn("PNG parse warning:",a)}return e}async function Ee(s){const m=await s.text(),e={fileName:s.name,metadata:{fileType:"SVG Image"}};try{const a=X(m),n=a.getElementsByTagName("title")[0],i=a.getElementsByTagName("desc")[0];n&&(e.metadata.title=Q(n)),i&&(e.metadata.description=Q(i));const r=a.getElementsByTagName("svg")[0];if(r){const l=r.getAttribute("sodipodi:docname")||r.getAttribute("docname");l&&(e.metadata.docName=l);const h=r.getAttribute("inkscape:version")||r.getAttribute("xmp:CreatorTool");h&&(e.metadata.creatorTool=h)}const u=oe(m);if(u){const l=G(u);Object.assign(e.metadata,l)}else{const l=a.getElementsByTagName("*");for(let h=0;h<l.length;h++){const o=l[h];if(o.localName==="creator"){const x=Q(o);if(x){e.metadata.author=x;break}}}}const f=[],c=String(e.metadata.author||"").trim(),d=String(e.metadata.creator||"").trim();c&&!k(c)&&f.push({type:"AUTHOR FOUND",value:c}),d&&!k(d)&&f.push({type:"CREATOR FOUND",value:d}),f.length&&(e.potentialIssues=f)}catch(a){console.warn("SVG parse warning:",a)}return e}async function $e(s){const m=await s.arrayBuffer(),e={fileName:s.name,metadata:{fileType:"TIFF Image"}};try{const a=await se(m);Object.assign(e.metadata,a);const n=e.metadata.__exifAll;n&&Object.keys(n).length&&(e.exif=n),delete e.metadata.__exifAll;const i=te(m);if(i){const c=G(i);Object.assign(e.metadata,c)}const r=[],u=String(e.metadata.author||"").trim(),f=String(e.metadata.creator||"").trim();u&&!k(u)&&r.push({type:"AUTHOR FOUND",value:u}),f&&!k(f)&&r.push({type:"CREATOR FOUND",value:f}),r.length&&(e.potentialIssues=r),i||(e.metadata.note="Basic TIFF metadata not parsed (XMP only)")}catch(a){console.warn("TIFF parse warning:",a)}return e}function te(s){const m=new Uint8Array(s),e=new TextDecoder("latin1").decode(m);return oe(e)}function oe(s){const m=s.indexOf("<x:xmpmeta");if(m===-1)return null;const e=s.indexOf("</x:xmpmeta>",m);return e===-1?null:s.substring(m,e+12)}function G(s){const m=X(s),e=ee(m),a={};if(e.title&&(a.title=D(e.title)),e.description&&(a.description=D(e.description)),e.creator){const n=D(e.creator);n&&(a.creator=n,a.author=a.author||n)}return e.rights&&(a.rights=D(e.rights)),e.Copyright&&(a.copyright=D(e.Copyright)),e.Artist&&(a.author=a.author||D(e.Artist)),e.CreatorTool&&(a.creatorTool=D(e.CreatorTool)),e.CreateDate&&(a.creationDate=z(D(e.CreateDate))),e.ModifyDate&&(a.modificationDate=z(D(e.ModifyDate))),e.MetadataDate&&(a.metadataDate=z(D(e.MetadataDate))),e.Credit&&(a.credit=D(e.Credit)),e.Source&&(a.source=D(e.Source)),a}function Ie(s){const m=new DataView(s),e=new Uint8Array(s),a={},n=[137,80,78,71,13,10,26,10];for(let r=0;r<n.length;r++)if(e[r]!==n[r])return a;let i=8;for(;i+8<=e.length;){const r=m.getUint32(i,!1),u=String.fromCharCode(e[i+4],e[i+5],e[i+6],e[i+7]),f=i+8,c=f+r;if(c+4>e.length)break;if(u==="tEXt"){const d=e.subarray(f,c),l=d.indexOf(0);if(l>0){const h=new TextDecoder("latin1").decode(d.subarray(0,l)),o=new TextDecoder("latin1").decode(d.subarray(l+1));a[h]=o}}else if(u==="iTXt"){const d=e.subarray(f,c);let l=0;const o=d.indexOf(0,l);if(o>0){const x=new TextDecoder("utf-8").decode(d.subarray(0,o));l=o+1;const g=d[l++];l++;const j=d.indexOf(0,l);l=j>=0?j+1:l;const v=d.indexOf(0,l);if(l=v>=0?v+1:l,g===0){const b=new TextDecoder("utf-8").decode(d.subarray(l));a[x]=b}}}if(i=c+4,u==="IEND")break}return a}function Q(s){return(s.textContent||"").trim()}async function se(s){try{let m;try{m=await xe(s)}catch{return{}}const e=x=>{const g=m[x];if(g)return typeof g.description<"u"?g.description:g.value},a={},n=e("Artist")||e("XPAuthor")||e("Author"),i=e("Creator")||e("XPSubject"),r=e("Software"),u=e("ImageDescription")||e("Description")||e("XPComment"),f=e("Copyright")||e("XPAuthor"),c=e("Credit"),d=e("Source"),l=e("DateTimeOriginal")||e("CreateDate")||e("CreationTime"),h=e("ModifyDate")||e("DateTime");n&&(a.author=String(n).trim()),i&&(a.creator=String(i).trim()),r&&(a.software=String(r).trim()),u&&(a.description=String(u).trim()),f&&(a.copyright=String(f).trim()),c&&(a.credit=String(c).trim()),d&&(a.source=String(d).trim()),l&&(a.creationDate=z(String(l))),h&&(a.modificationDate=z(String(h)));const o={};for(const x of Object.keys(m||{}))try{const g=m[x];let j;g&&typeof g=="object"?j=typeof g.description<"u"?g.description:g.value:j=g,Array.isArray(j)?o[x]=j.map(v=>String(v)).join(", "):j!=null?o[x]=typeof j=="object"?JSON.stringify(j):j:o[x]=null}catch{}return a.__exifAll=o,a}catch(m){return console.warn("EXIF parse warning:",m),{}}}function Be(){const[s,m]=U.useState([]),[e,a]=U.useState(!1),n=async u=>{a(!0);const f=await Promise.all(u.map(async c=>{try{const d=await Ce(c);return typeof c.type=="string"&&c.type.startsWith("image/")||/\.(jpe?g|png|svg|tiff?)$/i.test(c.name)?{...d,previewUrl:URL.createObjectURL(c)}:d}catch(d){return console.error("Error parsing file:",d),{fileName:c.name,metadata:{error:"Failed to parse file"}}}}));m(c=>[...f,...c]),a(!1)},i=()=>{try{s.forEach(u=>{u.previewUrl&&URL.revokeObjectURL(u.previewUrl)})}catch{}m([])},r=u=>{m(f=>{const c=f[u];try{c?.previewUrl&&URL.revokeObjectURL(c.previewUrl)}catch{}return f.filter((d,l)=>l!==u)})};return t.jsxs("div",{className:`min-h-screen font-sans ${s.length===0?"bg-white":"bg-gray-50"}`,children:[t.jsx("div",{className:"bg-white w-full",children:t.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:t.jsx(ye,{})})}),t.jsx("div",{className:"bg-white w-full",children:t.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:t.jsxs("div",{className:"mx-auto w-full md:w-[70%]",children:[t.jsx(we,{onFilesSelected:n}),e&&t.jsx("p",{className:"text-center mt-4 text-gray-600",children:"Processing files..."})]})})}),t.jsx("main",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:s.length>0&&t.jsx(Ne,{results:s,onClear:i,onRemove:r})}),t.jsx(be,{})]})}me.createRoot(document.getElementById("root")).render(t.jsx(U.StrictMode,{children:t.jsx(Be,{})}));
